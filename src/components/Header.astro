---
import HeaderLink from './HeaderLink.astro';
---

<header class="m-0 py-5 text-center border-b border-ctp-surface0 mb-10 sticky top-0 bg-ctp-base/80 backdrop-blur-md z-[100]">
	<nav class="w-full max-w-[1100px] mx-auto px-5 md:px-10">
        <div class="flex justify-between items-center mb-4 flex-wrap gap-2.5">
            <div class="m-0 py-1.5 px-2.5 bg-ctp-surface0 rounded text-[0.85em] font-mono text-ctp-subtext0">
                <span class="text-ctp-blue font-bold">guest</span>@<span class="text-ctp-red font-bold">portfolio</span>:<span class="text-ctp-yellow">/menu</span># ./navigation.sh
            </div>
            <button id="crt-toggle" class="bg-transparent border-none text-ctp-subtext0 cursor-pointer font-mono text-[0.85em] transition-colors hover:text-ctp-mauve" aria-label="Toggle CRT Effect">
                [ CRT: <span id="crt-status">ON</span> ]
            </button>
        </div>
		<div class="flex justify-start gap-5">
			<HeaderLink href="/" class="border-none text-lg text-ctp-subtext0 hover:text-ctp-mauve transition-colors [&.active]:text-ctp-mauve [&.active]:font-bold">home</HeaderLink>
			<HeaderLink href="/blog" class="border-none text-lg text-ctp-subtext0 hover:text-ctp-mauve transition-colors [&.active]:text-ctp-mauve [&.active]:font-bold">blog</HeaderLink>
			<HeaderLink href="/about" class="border-none text-lg text-ctp-subtext0 hover:text-ctp-mauve transition-colors [&.active]:text-ctp-mauve [&.active]:font-bold">about</HeaderLink>
		</div>
	</nav>
</header>

<script>
    const toggleButton = document.getElementById('crt-toggle');
    const statusText = document.getElementById('crt-status');
    const body = document.body;

    // Check local storage or default to true
    const isCrtEnabled = localStorage.getItem('crt-enabled') !== 'false';

    // Apply initial state
    if (isCrtEnabled) {
        body.classList.add('crt-active');
        if (statusText) statusText.textContent = 'ON';
    } else {
        body.classList.remove('crt-active');
        if (statusText) statusText.textContent = 'OFF';
    }

    toggleButton?.addEventListener('click', () => {
        const isActive = body.classList.toggle('crt-active');
        if (statusText) statusText.textContent = isActive ? 'ON' : 'OFF';
        localStorage.setItem('crt-enabled', isActive.toString());
    });
</script>
